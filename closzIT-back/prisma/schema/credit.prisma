/// 크레딧 거래 유형
enum CreditTransactionType {
  SIGNUP          // 회원가입 보상
  CLOTHING_ADDED  // 의류 등록 보상
  VTO_USED        // VTO 서비스 사용
  FLATTEN_USED    // 옷 펴기 서비스 사용
  ADMIN_ADD       // 관리자 지급
  ADMIN_SUB       // 관리자 차감
  ADMIN_SET       // 관리자 직접 설정
  ADMIN_FIX       // 정합성 복구
}

/// 크레딧 이력 테이블
model CreditHistory {
  id              String                @id @default(uuid())
  userId          String                @map("user_id")
  type            CreditTransactionType
  amount          Int
  balanceAfter    Int                   @map("balance_after")
  description     String?
  idempotencyKey  String?               @unique @map("idempotency_key")
  adminId         String?               @map("admin_id")
  createdAt       DateTime              @default(now()) @map("created_at")

  user  User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  admin User? @relation("AdminCreditActions", fields: [adminId], references: [id])

  @@index([userId])
  @@index([createdAt])
  @@index([type])
  @@map("credit_history")
}

